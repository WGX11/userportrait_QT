{"remainingRequest":"D:\\Project\\userportrait_QT\\user-portrait-for-qt-master\\frontend\\node_modules\\babel-loader\\lib\\index.js!D:\\Project\\userportrait_QT\\user-portrait-for-qt-master\\frontend\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!D:\\Project\\userportrait_QT\\user-portrait-for-qt-master\\frontend\\node_modules\\vue-loader-v16\\dist\\index.js??ref--0-1!D:\\Project\\userportrait_QT\\user-portrait-for-qt-master\\frontend\\src\\views\\Login.vue?vue&type=script&lang=js","dependencies":[{"path":"D:\\Project\\userportrait_QT\\user-portrait-for-qt-master\\frontend\\src\\views\\Login.vue","mtime":1699352770642},{"path":"D:\\Project\\userportrait_QT\\user-portrait-for-qt-master\\frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1699426402170},{"path":"D:\\Project\\userportrait_QT\\user-portrait-for-qt-master\\frontend\\node_modules\\babel-loader\\lib\\index.js","mtime":1699426403263},{"path":"D:\\Project\\userportrait_QT\\user-portrait-for-qt-master\\frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1699426402170},{"path":"D:\\Project\\userportrait_QT\\user-portrait-for-qt-master\\frontend\\node_modules\\vue-loader-v16\\dist\\index.js","mtime":1699426402439}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IHJlcXVlc3QgZnJvbSAiQC91dGlscy9yZXF1ZXN0IjsKaW1wb3J0IFZhbGlkQ29kZSBmcm9tICJAL2NvbXBvbmVudHMvVmFsaWRDb2RlIjsKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICJMb2dpbiIsCiAgY29tcG9uZW50czogewogICAgVmFsaWRDb2RlOiBWYWxpZENvZGUKICB9LAogIGRhdGE6IGZ1bmN0aW9uIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBvcHRpb25zOiBbXSwKICAgICAgZm9ybToge30sCiAgICAgIHJ1bGVzOiB7CiAgICAgICAgYWNjb3VudF9uYW1lOiBbewogICAgICAgICAgcmVxdWlyZWQ6IHRydWUsCiAgICAgICAgICBtZXNzYWdlOiAn6K+36L6T5YWl55So5oi35ZCNJywKICAgICAgICAgIHRyaWdnZXI6ICdibHVyJwogICAgICAgIH1dLAogICAgICAgIGFjY291bnRfcHdkOiBbewogICAgICAgICAgcmVxdWlyZWQ6IHRydWUsCiAgICAgICAgICBtZXNzYWdlOiAn6K+36L6T5YWl5a+G56CBJywKICAgICAgICAgIHRyaWdnZXI6ICdibHVyJwogICAgICAgIH1dLAogICAgICAgIGFwcF9pZDogW3sKICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLAogICAgICAgICAgbWVzc2FnZTogJ+ivt+mAieaLqeW6lOeUqCcsCiAgICAgICAgICB0cmlnZ2VyOiAnYmx1cicKICAgICAgICB9XQogICAgICB9LAogICAgICB2YWxpZENvZGU6ICcnIC8vIOWKoOiDjOaZr+WbvueJhwogICAgICAvLyBiZzogewogICAgICAvLyAgIGJhY2tncm91bmRJbWFnZTogInVybCgiICsgcmVxdWlyZSgiQC9hc3NldHMvYmcuanBnIikgKyAiKSIsCiAgICAgIC8vICAgYmFja2dyb3VuZFJlcGVhdDogIm5vLXJlcGVhdCIsCiAgICAgIC8vICAgYmFja2dyb3VuZFNpemU6ICIxMDAlIDEwMCUiCiAgICAgIC8vIH0KCiAgICB9OwogIH0sCiAgY3JlYXRlZDogZnVuY3Rpb24gY3JlYXRlZCgpIHsKICAgIHRoaXMuZ2V0QXBwTGlzdCgpOwogICAgc2Vzc2lvblN0b3JhZ2UucmVtb3ZlSXRlbSgidG9rZW4iKTsKICB9LAogIG1ldGhvZHM6IHsKICAgIC8vIOaOpeaUtumqjOivgeeggee7hOS7tuaPkOS6pOeahCA05L2N6aqM6K+B56CBCiAgICBjcmVhdGVWYWxpZENvZGU6IGZ1bmN0aW9uIGNyZWF0ZVZhbGlkQ29kZShkYXRhKSB7CiAgICAgIHRoaXMudmFsaWRDb2RlID0gZGF0YTsKICAgIH0sCiAgICAvLyDojrflj5blupTnlKjliJfooaggCiAgICBnZXRBcHBMaXN0OiBmdW5jdGlvbiBnZXRBcHBMaXN0KCkgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgcmVxdWVzdC5nZXQoIi9hcHBsaXN0IikudGhlbihmdW5jdGlvbiAocmVzKSB7CiAgICAgICAgY29uc29sZS5sb2cocmVzKTsKCiAgICAgICAgaWYgKHJlcy5zdGF0dXNfY29kZSA9PT0gMCkgewogICAgICAgICAgX3RoaXMub3B0aW9ucyA9IHJlcy5hcHBzOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBfdGhpcy4kbWVzc2FnZSh7CiAgICAgICAgICAgIHR5cGU6ICJlcnJvciIsCiAgICAgICAgICAgIG1lc3NhZ2U6IHJlcy5zdGF0dXNfbXNnCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfSwKICAgIGxvZ2luOiBmdW5jdGlvbiBsb2dpbigpIHsKICAgICAgdmFyIF90aGlzMiA9IHRoaXM7CgogICAgICB0aGlzLiRyZWZzWydmb3JtJ10udmFsaWRhdGUoZnVuY3Rpb24gKHZhbGlkKSB7CiAgICAgICAgaWYgKHZhbGlkKSB7CiAgICAgICAgICBpZiAoIV90aGlzMi5mb3JtLnZhbGlkQ29kZSkgewogICAgICAgICAgICBfdGhpczIuJG1lc3NhZ2UuZXJyb3IoIuivt+Whq+WGmemqjOivgeeggSIpOwoKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgfQoKICAgICAgICAgIGlmIChfdGhpczIuZm9ybS52YWxpZENvZGUudG9Mb3dlckNhc2UoKSAhPT0gX3RoaXMyLnZhbGlkQ29kZS50b0xvd2VyQ2FzZSgpKSB7CiAgICAgICAgICAgIF90aGlzMi4kbWVzc2FnZS5lcnJvcigi6aqM6K+B56CB6ZSZ6K+vIik7CgogICAgICAgICAgICByZXR1cm47CiAgICAgICAgICB9CgogICAgICAgICAgY29uc29sZS5sb2coImxvZ2luLi4uaW5nIik7CiAgICAgICAgICByZXF1ZXN0LnBvc3QoIi9sb2dpbiIsIF90aGlzMi5mb3JtKS50aGVuKGZ1bmN0aW9uIChyZXMpIHsKICAgICAgICAgICAgY29uc29sZS5sb2cocmVzKTsKCiAgICAgICAgICAgIGlmIChyZXMuc3RhdHVzX2NvZGUgPT09IDIwMCkgewogICAgICAgICAgICAgIF90aGlzMi4kbWVzc2FnZSh7CiAgICAgICAgICAgICAgICB0eXBlOiAic3VjY2VzcyIsCiAgICAgICAgICAgICAgICBtZXNzYWdlOiAi55m75b2V5oiQ5YqfIgogICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICBzZXNzaW9uU3RvcmFnZS5zZXRJdGVtKCJ0b2tlbiIsIHJlcy50b2tlbik7IC8vIOe8k+WtmHRva2VuCgogICAgICAgICAgICAgIF90aGlzMi4kZm9yY2VVcGRhdGUoKTsgLy8g6LSm5Y+35L+h5oGvCgoKICAgICAgICAgICAgICByZXF1ZXN0LmdldCgiL2FwaS9hY2NvdW50IikudGhlbihmdW5jdGlvbiAocmVzKSB7CiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhyZXMpOwoKICAgICAgICAgICAgICAgIGlmIChyZXMuc3RhdHVzX2NvZGUgPT09IDApIHsKICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coInNldCBzZXNzaW9uIGFjY291bnQiKTsKICAgICAgICAgICAgICAgICAgdmFyIGFjY291bnRPYmogPSByZXMuYWNjb3VudDsKICAgICAgICAgICAgICAgICAgdmFyIGFjY291bnRTdHIgPSBKU09OLnN0cmluZ2lmeShhY2NvdW50T2JqKTsKICAgICAgICAgICAgICAgICAgc2Vzc2lvblN0b3JhZ2Uuc2V0SXRlbSgiYWNjb3VudCIsIGFjY291bnRTdHIpOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coIi9hcGkvYWNjb3VudCBjb2RlICE9IDAsIGNvZGU9IiwgcmVzLnN0YXR1c19jb2RlKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgX3RoaXMyLiRyb3V0ZXIucHVzaCgiL2Zyb250L3Byb2ZpbGUiKTsgLy8g55m75b2V55WM6Z2i6Lez6L2sCgoKICAgICAgICAgICAgICBfdGhpczIuJGZvcmNlVXBkYXRlKCk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgX3RoaXMyLiRtZXNzYWdlKHsKICAgICAgICAgICAgICAgIHR5cGU6ICJlcnJvciIsCiAgICAgICAgICAgICAgICBtZXNzYWdlOiByZXMuc3RhdHVzX21zZwogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9CiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfQogIH0KfTs="},{"version":3,"sources":["D:\\Project\\userportrait_QT\\user-portrait-for-qt-master\\frontend\\src\\views\\Login.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\r\n  <div style=\"width: 100%; height: 100vh; overflow: hidden\"> <!--  :style=\"bg\" 加背景图片-->\r\n    <div style=\"width: 400px; margin: 100px auto\">\r\n      <div style=\"font-size: 30px; text-align: center; padding: 30px 0\">用户行为画像系统登录</div>\r\n      <el-form ref=\"form\" :model=\"form\" :rules=\"rules\">\r\n        <el-form-item prop=\"app_id\">\r\n          <el-select v-model=\"form.app_id\" placeholder=\"请选择应用\">\r\n            <el-option v-for=\"item in options\" :key=\"item.app_id\" :label=\"item.app_name\" :value=\"item.app_id\"></el-option>\r\n          </el-select>\r\n        </el-form-item>\r\n        <el-form-item prop=\"account_name\">\r\n          <el-input prefix-icon=\"el-icon-user-solid\" v-model=\"form.account_name\" placeholder=\"请输入账号\"></el-input>\r\n        </el-form-item>\r\n        <el-form-item prop=\"account_pwd\">\r\n          <el-input prefix-icon=\"el-icon-lock\" v-model=\"form.account_pwd\" show-password placeholder=\"请输入密码\"></el-input>\r\n        </el-form-item>\r\n        <el-form-item>\r\n          <div style=\"display: flex\">\r\n            <el-input prefix-icon=\"el-icon-key\" v-model=\"form.validCode\" style=\"width: 50%;\"\r\n                      placeholder=\"请输入验证码\"></el-input>\r\n            <ValidCode @input=\"createValidCode\"/>\r\n          </div>\r\n        </el-form-item>\r\n        <el-form-item>\r\n          <el-button style=\"width: 100%\" type=\"primary\" @click=\"login\">登 录</el-button>\r\n        </el-form-item>\r\n        <el-form-item>\r\n          <el-button type=\"text\" @click=\"$router.push('/register')\">创建应用 >></el-button>\r\n        </el-form-item>\r\n      </el-form>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport request from \"@/utils/request\";\r\nimport ValidCode from \"@/components/ValidCode\";\r\n\r\nexport default {\r\n  name: \"Login\",\r\n  components: {\r\n    ValidCode\r\n  },\r\n  data() {\r\n    return {\r\n      options: [],\r\n      form: {},\r\n      rules: {\r\n        account_name: [\r\n          {required: true, message: '请输入用户名', trigger: 'blur'},\r\n        ],\r\n        account_pwd: [\r\n          {required: true, message: '请输入密码', trigger: 'blur'},\r\n        ],\r\n        app_id: [\r\n          {required: true, message: '请选择应用', trigger: 'blur'},\r\n        ],\r\n      },\r\n      validCode: ''\r\n      // 加背景图片\r\n      // bg: {\r\n      //   backgroundImage: \"url(\" + require(\"@/assets/bg.jpg\") + \")\",\r\n      //   backgroundRepeat: \"no-repeat\",\r\n      //   backgroundSize: \"100% 100%\"\r\n      // }\r\n    }\r\n  },\r\n  created() {\r\n    this.getAppList();\r\n    sessionStorage.removeItem(\"token\")\r\n  },\r\n  methods: {\r\n    // 接收验证码组件提交的 4位验证码\r\n    createValidCode(data) {\r\n      this.validCode = data\r\n    },\r\n    // 获取应用列表 \r\n    getAppList() {\r\n      request.get(\"/applist\").then(res => {\r\n          console.log(res)\r\n          if (res.status_code === 0) {\r\n            this.options = res.apps\r\n          } else {\r\n             this.$message({\r\n                  type: \"error\",\r\n                  message: res.status_msg\r\n                })\r\n          }\r\n      }\r\n      )\r\n    },\r\n    login() {\r\n      this.$refs['form'].validate((valid) => {\r\n        if (valid) {\r\n          if (!this.form.validCode) {\r\n            this.$message.error(\"请填写验证码\")\r\n            return\r\n          }\r\n          if (this.form.validCode.toLowerCase() !== this.validCode.toLowerCase()) {\r\n            this.$message.error(\"验证码错误\")\r\n            return\r\n          }\r\n          console.log(\"login...ing\")\r\n          request.post(\"/login\", this.form).then(res => {\r\n            console.log(res)\r\n            if (res.status_code === 200) {\r\n              this.$message({\r\n                  type: \"success\",\r\n                  message: \"登录成功\"\r\n              })\r\n              sessionStorage.setItem(\"token\", res.token) // 缓存token\r\n              this.$forceUpdate()\r\n              // 账号信息\r\n              request.get(\"/api/account\").then(res => {\r\n                console.log(res)\r\n                if (res.status_code === 0) {\r\n                  console.log(\"set session account\")\r\n                  let accountObj = res.account\r\n                  let accountStr = JSON.stringify(accountObj)\r\n                  sessionStorage.setItem(\"account\",accountStr)\r\n                } else {\r\n                  console.log(\"/api/account code != 0, code=\",res.status_code)\r\n                }\r\n              })\r\n    \r\n              this.$router.push(\"/front/profile\") // 登录界面跳转\r\n              this.$forceUpdate()\r\n            } else {\r\n              this.$message({\r\n                type: \"error\",\r\n                message: res.status_msg\r\n              })\r\n            }\r\n          })\r\n        }\r\n      })\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n\r\n</style>\r\n"],"sourceRoot":""}]}